<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shugur Network - Relay Dashboard</title>
    <meta name="description" content="Enterprise-grade monitoring dashboard for Shugur relay network">
    <meta name="keywords" content="nostr, relay, monitoring, shugur, network, dashboard">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://shugur.net/">
    <meta property="og:title" content="Shugur Network - Relay Dashboard">
    <meta property="og:description" content="Enterprise-grade monitoring dashboard for Shugur relay network">
    <meta property="og:image" content="https://shugur.net/og-image.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://shugur.net/">
    <meta property="twitter:title" content="Shugur Network - Relay Dashboard">
    <meta property="twitter:description" content="Enterprise-grade monitoring dashboard for Shugur relay network">
    <meta property="twitter:image" content="https://shugur.net/og-image.png">
    
    <!-- Preconnect to external resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Inter font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        }
        
        /* Ensure dashboard is hidden by default to prevent flash */
        #dashboard {
            display: none !important;
        }
        
        #dashboard.show {
            display: flex !important;
        }
        
        .loading-dots {
            display: inline-block;
        }
        
        .loading-dots::after {
            content: '';
            animation: loading-dots 1.5s infinite;
        }
        
        @keyframes loading-dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }
        
        /* Status badges */
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }
        
        .status-badge.online {
            background-color: #dcfce7;
            color: #166534;
        }
        
        .status-badge.idle {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .status-badge.connecting {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .status-badge.offline {
            background-color: #fee2e2;
            color: #dc2626;
        }
        
        /* Dark mode status badges */
        .dark .status-badge.online {
            background-color: #14532d;
            color: #bbf7d0;
        }
        
        .dark .status-badge.idle {
            background-color: #78350f;
            color: #fde68a;
        }
        
        .dark .status-badge.connecting {
            background-color: #1e3a8a;
            color: #93c5fd;
        }
        
        .dark .status-badge.offline {
            background-color: #7f1d1d;
            color: #fca5a5;
        }
        
        /* Progress bars */
        .progress-bar {
            width: 100%;
            height: 0.5rem;
            background-color: #e5e7eb;
            border-radius: 9999px;
            overflow: hidden;
        }
        
        .dark .progress-bar {
            background-color: #374151;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #1d4ed8);
            border-radius: 9999px;
            transition: width 0.3s ease;
        }
        
        .progress-fill.high-load {
            background: linear-gradient(90deg, #f59e0b, #d97706);
        }
        
        .progress-fill.critical-load {
            background: linear-gradient(90deg, #ef4444, #dc2626);
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
    <div id="app">
        <!-- Loading Screen -->
        <div id="loading-screen" class="fixed inset-0 bg-white dark:bg-gray-900 flex items-center justify-center z-50">
            <div class="text-center">
                <div class="w-16 h-16 border-4 border-primary-200 border-t-primary-500 rounded-full animate-spin mx-auto mb-4"></div>
                <h2 class="text-xl font-semibold text-gray-700 dark:text-gray-300">Loading Shugur Network</h2>
                <p class="text-gray-500 dark:text-gray-400 loading-dots">Retrieving network informations</p>
            </div>
        </div>

        <!-- Main Dashboard -->
        <div id="dashboard" class="hidden min-h-screen flex flex-col">
            <!-- Header -->
            <header class="bg-white dark:bg-gray-900 shadow-sm border-b border-gray-200 dark:border-gray-700">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="flex justify-between items-center h-16">
                        <div class="flex items-center">
                            <img src="./shugur-logo-full.svg" alt="Shugur Network" class="h-8">
                        </div>
                        <nav class="hidden md:flex items-center space-x-8">
                            <a href="https://docs.shugur.com" class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Documentation</a>
                            <a href="https://github.com/Shugur-Network" class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">GitHub</a>
                        </nav>
                    </div>
                </div>
            </header>

            <!-- Main Content -->
            <main class="flex-1 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Network Performance -->
            <div class="mb-8">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Network Performance</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <!-- Total Active Connections -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                    </svg>
                                </div>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Total Active Connections</p>
                                <p class="text-2xl font-bold text-gray-900 dark:text-white" id="total-connections">--</p>
                            </div>
                        </div>
                    </div>

                    <!-- Messages Processed -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-10 h-10 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                    </svg>
                                </div>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Processed Requests</p>
                                <p class="text-2xl font-bold text-gray-900 dark:text-white" id="total-messages">--</p>
                            </div>
                        </div>
                    </div>

                    <!-- Events Stored -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-10 h-10 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-purple-600 dark:text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"></path>
                                    </svg>
                                </div>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Stored Events</p>
                                <p class="text-2xl font-bold text-gray-900 dark:text-white" id="total-events-stored">--</p>
                            </div>
                        </div>
                    </div>

                    <!-- Network Uptime -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-10 h-10 bg-amber-100 dark:bg-amber-900 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-amber-600 dark:text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Network Uptime</p>
                                <p class="text-2xl font-bold text-gray-900 dark:text-white" id="network-uptime">--</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Relay Nodes -->
            <div class="mb-8">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Network Status</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="relay-nodes">
                    <!-- Relay nodes will be dynamically generated from cluster discovery -->
                </div>
            </div>

            <!-- Charts Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Messages Delta Chart -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Requests</h3>
                    <div class="h-64">
                        <canvas id="messages-chart"></canvas>
                    </div>
                </div>

                <!-- Events Delta Chart -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Events</h3>
                    <div class="h-64">
                        <canvas id="events-chart"></canvas>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700 mt-auto">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Quick Access -->
                    <div>
                        <h3 class="text-sm font-semibold text-gray-900 dark:text-white mb-4">Quick Access</h3>
                        <ul class="space-y-2">
                            <li>
                                <a href="https://docs.shugur.com" class="text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
                                    Documentation
                                </a>
                                <p class="text-xs text-gray-500 dark:text-gray-500">Guides, API reference</p>
                            </li>
                        </ul>
                    </div>

                    <!-- Connect to Network -->
                    <div>
                        <h3 class="text-sm font-semibold text-gray-900 dark:text-white mb-4">Connect to Network</h3>
                        <div class="space-y-3">
                            <div>
                                <h4 class="text-xs font-medium text-gray-700 dark:text-gray-300">Direct Node Access</h4>
                                <div id="footer-relay-list" class="text-xs space-y-1">
                                    <!-- Relay endpoints will be populated dynamically -->
                                </div>
                                <div id="view-all-button" class="mt-2 hidden">
                                    <button onclick="openAllRelaysModal()" class="text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 underline">
                                        View All Relays
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Company Info -->
                    <div>
                        <div class="mb-4">
                            <img src="./shugur-logo-full.svg" alt="Shugur Network" class="h-6 mb-2">
                        </div>
                        <p class="text-xs text-gray-600 dark:text-gray-400 mb-4">
                            Build open, resilient tech for everyone.
                        </p>
                        <div class="flex space-x-4">
                            <a href="https://shugur.com" class="text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
                                Company
                            </a>
                            <a href="https://github.com/Shugur-Network" class="text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
                                GitHub
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Copyright -->
                <div class="border-t border-gray-200 dark:border-gray-700 pt-6 mt-8">
                    <p class="text-xs text-gray-500 dark:text-gray-500 text-center">
                        Â© <span id="current-year">2025</span> Shugur Network. Build open, resilient tech for everyone.
                    </p>
                </div>
            </div>
        </footer>
        </div>
    </div>

    <!-- All Relays Modal -->
    <div id="all-relays-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-hidden">
            <div class="flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-700">
                <h2 class="text-xl font-semibold text-gray-900 dark:text-white">All Relay Nodes</h2>
                <button onclick="closeAllRelaysModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="p-6 overflow-auto max-h-[calc(90vh-120px)]">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Node</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Endpoint</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Location</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Connections</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Requests</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Response Time</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Uptime</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Load</th>
                            </tr>
                        </thead>
                        <tbody id="all-relays-table-body" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                            <!-- Table rows will be populated dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="/src/main.js"></script>
</body>
</html>
